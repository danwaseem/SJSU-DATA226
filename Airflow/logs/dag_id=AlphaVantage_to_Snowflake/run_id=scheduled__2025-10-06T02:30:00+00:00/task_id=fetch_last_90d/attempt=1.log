[2025-10-07T19:46:44.127+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-10-07T19:46:44.205+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: AlphaVantage_to_Snowflake.fetch_last_90d scheduled__2025-10-06T02:30:00+00:00 [queued]>
[2025-10-07T19:46:44.254+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: AlphaVantage_to_Snowflake.fetch_last_90d scheduled__2025-10-06T02:30:00+00:00 [queued]>
[2025-10-07T19:46:44.256+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 1
[2025-10-07T19:46:44.304+0000] {taskinstance.py:2888} INFO - Executing <Task(_PythonDecoratedOperator): fetch_last_90d> on 2025-10-06 02:30:00+00:00
[2025-10-07T19:46:44.362+0000] {logging_mixin.py:190} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70 DeprecationWarning: This process (pid=267) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-10-07T19:46:44.365+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'AlphaVantage_to_Snowflake', 'fetch_last_90d', 'scheduled__2025-10-06T02:30:00+00:00', '--job-id', '143', '--raw', '--subdir', 'DAGS_FOLDER/hw5_final.py', '--cfg-path', '/tmp/tmpg9yd7qib']
[2025-10-07T19:46:44.376+0000] {standard_task_runner.py:105} INFO - Job 143: Subtask fetch_last_90d
[2025-10-07T19:46:44.372+0000] {standard_task_runner.py:72} INFO - Started process 287 to run task
[2025-10-07T19:46:44.787+0000] {task_command.py:467} INFO - Running <TaskInstance: AlphaVantage_to_Snowflake.fetch_last_90d scheduled__2025-10-06T02:30:00+00:00 [running]> on host 055b0adf81a0
[2025-10-07T19:46:45.636+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='AlphaVantage_to_Snowflake' AIRFLOW_CTX_TASK_ID='fetch_last_90d' AIRFLOW_CTX_EXECUTION_DATE='2025-10-06T02:30:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-10-06T02:30:00+00:00'
[2025-10-07T19:46:45.646+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-10-07T19:46:46.049+0000] {python.py:240} INFO - Done. Returned value was: [{'1. open': '353.9100', '2. high': '355.2250', '3. low': '349.0561', '4. close': '349.9400', '5. volume': '1725369', 'date': '2025-10-06'}, {'1. open': '341.2800', '2. high': '357.0000', '3. low': '341.0900', '4. close': '350.5000', '5. volume': '2683073', 'date': '2025-10-03'}, {'1. open': '329.0000', '2. high': '341.3900', '3. low': '328.9000', '4. close': '340.2400', '5. volume': '2182141', 'date': '2025-10-02'}, {'1. open': '324.0300', '2. high': '332.7700', '3. low': '323.0600', '4. close': '332.6600', '5. volume': '2128508', 'date': '2025-10-01'}, {'1. open': '319.2100', '2. high': '325.2210', '3. low': '317.2200', '4. close': '323.1200', '5. volume': '1854874', 'date': '2025-09-30'}, {'1. open': '318.3100', '2. high': '321.6300', '3. low': '316.0100', '4. close': '319.6900', '5. volume': '1139336', 'date': '2025-09-29'}, {'1. open': '319.3500', '2. high': '320.1724', '3. low': '316.2801', '4. close': '318.6100', '5. volume': '1482009', 'date': '2025-09-26'}, {'1. open': '326.0000', '2. high': '328.0400', '3. low': '315.5200', '4. close': '316.7000', '5. volume': '1860727', 'date': '2025-09-25'}, {'1. open': '324.6100', '2. high': '329.0500', '3. low': '319.8500', '4. close': '326.3800', '5. volume': '2096779', 'date': '2025-09-24'}, {'1. open': '317.2750', '2. high': '324.9100', '3. low': '317.2750', '4. close': '323.7300', '5. volume': '2118644', 'date': '2025-09-23'}, {'1. open': '311.9800', '2. high': '318.9700', '3. low': '311.0000', '4. close': '317.8900', '5. volume': '1456336', 'date': '2025-09-22'}, {'1. open': '316.8200', '2. high': '318.2100', '3. low': '313.4000', '4. close': '313.7100', '5. volume': '3117579', 'date': '2025-09-19'}, {'1. open': '309.2300', '2. high': '316.5000', '3. low': '307.9650', '4. close': '315.7700', '5. volume': '2310141', 'date': '2025-09-18'}, {'1. open': '311.5000', '2. high': '315.7900', '3. low': '307.1800', '4. close': '308.4800', '5. volume': '1621309', 'date': '2025-09-17'}, {'1. open': '307.6900', '2. high': '311.3300', '3. low': '304.3303', '4. close': '310.0000', '5. volume': '2068117', 'date': '2025-09-16'}, {'1. open': '311.8000', '2. high': '313.4600', '3. low': '306.0000', '4. close': '306.9100', '5. volume': '2001778', 'date': '2025-09-15'}, {'1. open': '317.4200', '2. high': '319.2400', '3. low': '311.3400', '4. close': '311.7600', '5. volume': '1503394', 'date': '2025-09-12'}, {'1. open': '314.0100', '2. high': '317.6000', '3. low': '311.1350', '4. close': '314.8900', '5. volume': '3594533', 'date': '2025-09-11'}, {'1. open': '310.2200', '2. high': '312.8138', '3. low': '304.6300', '4. close': '306.7500', '5. volume': '1723812', 'date': '2025-09-10'}, {'1. open': '310.5500', '2. high': '316.8750', '3. low': '309.3000', '4. close': '315.0900', '5. volume': '1927036', 'date': '2025-09-09'}, {'1. open': '315.6200', '2. high': '318.1250', '3. low': '306.6966', '4. close': '308.1600', '5. volume': '2006243', 'date': '2025-09-08'}, {'1. open': '308.5000', '2. high': '315.2674', '3. low': '304.1600', '4. close': '313.6400', '5. volume': '1862268', 'date': '2025-09-05'}, {'1. open': '308.6000', '2. high': '313.8500', '3. low': '306.3750', '4. close': '308.0500', '5. volume': '2826948', 'date': '2025-09-04'}, {'1. open': '319.6600', '2. high': '323.9550', '3. low': '317.4600', '4. close': '321.5900', '5. volume': '1638639', 'date': '2025-09-03'}, {'1. open': '319.4900', '2. high': '325.6550', '3. low': '317.7500', '4. close': '322.3300', '5. volume': '1950206', 'date': '2025-09-02'}, {'1. open': '310.7400', '2. high': '320.1000', '3. low': '310.4450', '4. close': '318.6500', '5. volume': '3115375', 'date': '2025-08-29'}, {'1. open': '311.1500', '2. high': '311.1750', '3. low': '305.3400', '4. close': '310.4100', '5. volume': '1193747', 'date': '2025-08-28'}, {'1. open': '309.4800', '2. high': '312.5250', '3. low': '306.8500', '4. close': '309.8100', '5. volume': '1463037', 'date': '2025-08-27'}, {'1. open': '312.4300', '2. high': '313.8400', '3. low': '307.6000', '4. close': '310.0300', '5. volume': '1843693', 'date': '2025-08-26'}, {'1. open': '316.3100', '2. high': '317.0600', '3. low': '312.6250', '4. close': '314.0000', '5. volume': '1239133', 'date': '2025-08-25'}, {'1. open': '312.6600', '2. high': '319.2200', '3. low': '312.5450', '4. close': '316.5500', '5. volume': '2961618', 'date': '2025-08-22'}, {'1. open': '310.0000', '2. high': '313.6300', '3. low': '308.6100', '4. close': '309.6000', '5. volume': '1593528', 'date': '2025-08-21'}, {'1. open': '312.6100', '2. high': '316.8200', '3. low': '309.8400', '4. close': '310.0000', '5. volume': '2135268', 'date': '2025-08-20'}, {'1. open': '310.2700', '2. high': '315.9900', '3. low': '308.5300', '4. close': '312.0000', '5. volume': '2644220', 'date': '2025-08-19'}, {'1. open': '313.0000', '2. high': '316.5900', '3. low': '309.2300', '4. close': '309.3200', '5. volume': '2509279', 'date': '2025-08-18'}, {'1. open': '311.0000', '2. high': '312.0000', '3. low': '304.0955', '4. close': '309.5700', '5. volume': '3415622', 'date': '2025-08-15'}, {'1. open': '294.1400', '2. high': '296.9200', '3. low': '290.4700', '4. close': '295.4300', '5. volume': '2152973', 'date': '2025-08-14'}, {'1. open': '294.0900', '2. high': '298.9100', '3. low': '291.5700', '4. close': '294.4300', '5. volume': '2471475', 'date': '2025-08-13'}, {'1. open': '291.1700', '2. high': '293.4000', '3. low': '289.7200', '4. close': '292.4800', '5. volume': '1524315', 'date': '2025-08-12'}, {'1. open': '294.9900', '2. high': '299.4468', '3. low': '289.9700', '4. close': '290.7900', '5. volume': '1650213', 'date': '2025-08-11'}, {'1. open': '283.7200', '2. high': '295.1800', '3. low': '283.7200', '4. close': '293.9900', '5. volume': '2405187', 'date': '2025-08-08'}, {'1. open': '278.9200', '2. high': '284.5500', '3. low': '278.2000', '4. close': '283.4800', '5. volume': '2237438', 'date': '2025-08-07'}, {'1. open': '276.0100', '2. high': '280.7950', '3. low': '273.7100', '4. close': '276.3000', '5. volume': '2486971', 'date': '2025-08-06'}, {'1. open': '274.3100', '2. high': '282.7500', '3. low': '274.2800', '4. close': '276.4100', '5. volume': '2012955', 'date': '2025-08-05'}, {'1. open': '274.4000', '2. high': '280.4600', '3. low': '274.0400', '4. close': '274.9300', '5. volume': '3387400', 'date': '2025-08-04'}, {'1. open': '286.0000', '2. high': '288.0900', '3. low': '273.8400', '4. close': '274.6600', '5. volume': '3382622', 'date': '2025-08-01'}, {'1. open': '290.1400', '2. high': '293.0000', '3. low': '282.6500', '4. close': '283.0800', '5. volume': '3261397', 'date': '2025-07-31'}, {'1. open': '290.9400', '2. high': '294.6000', '3. low': '286.2200', '4. close': '293.5500', '5. volume': '2133238', 'date': '2025-07-30'}, {'1. open': '284.5000', '2. high': '295.2000', '3. low': '281.2500', '4. close': '288.7300', '5. volume': '2661174', 'date': '2025-07-29'}, {'1. open': '288.7800', '2. high': '291.5000', '3. low': '283.5000', '4. close': '285.9800', '5. volume': '2470389', 'date': '2025-07-28'}, {'1. open': '283.6600', '2. high': '294.3200', '3. low': '283.0001', '4. close': '289.1000', '5. volume': '4808070', 'date': '2025-07-25'}, {'1. open': '290.0000', '2. high': '295.6760', '3. low': '279.7600', '4. close': '280.4300', '5. volume': '3569423', 'date': '2025-07-24'}, {'1. open': '283.6000', '2. high': '296.6400', '3. low': '281.7900', '4. close': '296.6000', '5. volume': '3249791', 'date': '2025-07-23'}, {'1. open': '275.9900', '2. high': '283.4600', '3. low': '275.9900', '4. close': '281.7200', '5. volume': '3505396', 'date': '2025-07-22'}, {'1. open': '278.3500', '2. high': '281.1300', '3. low': '274.4000', '4. close': '276.4500', '5. volume': '3583447', 'date': '2025-07-21'}, {'1. open': '290.3100', '2. high': '293.3099', '3. low': '276.4139', '4. close': '277.0900', '5. volume': '8394411', 'date': '2025-07-18'}, {'1. open': '334.0000', '2. high': '334.0000', '3. low': '296.3900', '4. close': '302.4500', '5. volume': '7408729', 'date': '2025-07-17'}, {'1. open': '337.6000', '2. high': '346.3600', '3. low': '336.2000', '4. close': '344.5500', '5. volume': '2488087', 'date': '2025-07-16'}, {'1. open': '339.4300', '2. high': '343.6900', '3. low': '335.6800', '4. close': '336.2100', '5. volume': '1739817', 'date': '2025-07-15'}, {'1. open': '337.7500', '2. high': '340.2700', '3. low': '335.1700', '4. close': '340.0700', '5. volume': '1652847', 'date': '2025-07-14'}, {'1. open': '343.6900', '2. high': '344.3400', '3. low': '337.6100', '4. close': '340.6700', '5. volume': '1698417', 'date': '2025-07-11'}, {'1. open': '342.6000', '2. high': '348.5000', '3. low': '339.3900', '4. close': '345.8600', '5. volume': '2218484', 'date': '2025-07-10'}, {'1. open': '347.0000', '2. high': '348.0000', '3. low': '342.6300', '4. close': '346.3600', '5. volume': '1822210', 'date': '2025-07-09'}]
[2025-10-07T19:46:46.158+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-10-07T19:46:46.159+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=AlphaVantage_to_Snowflake, task_id=fetch_last_90d, run_id=scheduled__2025-10-06T02:30:00+00:00, execution_date=20251006T023000, start_date=20251007T194644, end_date=20251007T194646
[2025-10-07T19:46:46.235+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-10-07T19:46:46.255+0000] {taskinstance.py:3925} ERROR - Error scheduling downstream tasks. Skipping it as this is entirely optional optimisation. There might be various reasons for it, please take a look at the stack trace to figure out if the root cause can be diagnosed and fixed. See the issue https://github.com/apache/***/issues/39717 for details and an example problem. If you would like to get help in solving root cause, open discussion with all details with your managed service support or in Airflow repository.
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3921, in schedule_downstream_tasks
    return TaskInstance._schedule_downstream_tasks(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3870, in _schedule_downstream_tasks
    partial_dag = task.dag.partial_subset(
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 2664, in partial_subset
    t.task_id: _deepcopy_task(t)
               ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 2661, in _deepcopy_task
    return copy.deepcopy(t, memo)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 143, in deepcopy
    y = copier(memo)
        ^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 1388, in __deepcopy__
    setattr(result, k, copy.deepcopy(v, memo))
                       ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 136, in deepcopy
    y = copier(x, memo)
        ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 221, in _deepcopy_dict
    y[deepcopy(key, memo)] = deepcopy(value, memo)
                             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 136, in deepcopy
    y = copier(x, memo)
        ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 201, in _deepcopy_tuple
    y = [deepcopy(a, memo) for a in x]
         ^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 162, in deepcopy
    y = _reconstruct(x, memo, *rv)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 259, in _reconstruct
    state = deepcopy(state, memo)
            ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 136, in deepcopy
    y = copier(x, memo)
        ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 221, in _deepcopy_dict
    y[deepcopy(key, memo)] = deepcopy(value, memo)
                             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 162, in deepcopy
    y = _reconstruct(x, memo, *rv)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 259, in _reconstruct
    state = deepcopy(state, memo)
            ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 136, in deepcopy
    y = copier(x, memo)
        ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 221, in _deepcopy_dict
    y[deepcopy(key, memo)] = deepcopy(value, memo)
                             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 151, in deepcopy
    rv = reductor(4)
         ^^^^^^^^^^^
TypeError: cannot pickle '_thread.lock' object
[2025-10-07T19:46:46.262+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
